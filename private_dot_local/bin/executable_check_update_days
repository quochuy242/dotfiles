#!/bin/bash

# The file to store the last update timestamp
LAST_UPDATE_FILE="$HOME/.last_system_update"

# Check the notify-send command
if ! command -v notify-send &> /dev/null; then
  echo "notify-send command not available, please install libnotify-bin"
  exit 1
fi

# Check if the last update file exists and is not empty
if [ ! -s "$LAST_UPDATE_FILE" ]; then
   notify-send -i dialog-error "Update Error" "Could not determine last update time."
   # Optional: You could write the current time here to initialize it
   date +%s > "$LAST_UPDATE_FILE"
   exit 0
fi

# Get the current timestamp
NOW=$(date +%s)

# Read the date string from the file
LAST_UPDATE=$(cat "$LAST_UPDATE_FILE")



# Calculate the difference in days
DIFF_DAYS=$(( (NOW - LAST_UPDATE) / 86400 ))


if [ "$DIFF_DAYS" -eq 0 ]; then
    notify-send "Update Info" "Your system was updated today âœ¨" -i "software-update-available"
elif [ "$DIFF_DAYS" -eq 1 ]; then
    notify-send "Update Info" "Your system was updated yesterday." -i "software-update-available"
else
    notify-send "Update Info" "Your system was updated $DIFF_DAYS days ago." -i "system-help"
fi

exit 0
